{
  "general": {
    "headless_mode": false,
    "override": false,
    "skip_tests": false,
    "with_dependencies": false
  },
  "compilation": {
    "source_dirname": "src",
    "batch_size": 10,
    "thread_count": -1,
    "transport": "file"
  },
  "databases": [
    {
      "name": "MongoDB",
      "alias": "mongo",
      "imports": {
        "driver": {
          "path": "driver import from \"...\""
        },
        "storage": {
          "path": "storage import from \"...\""
        }
      },
      "mappings": [
        {
          "db_type": "ObjectID",
          "code_type": "ObjectID"
        },
        {
          "db_type": "Long",
          "code_type": "bigint"
        },
        {
          "db_type": "ISODate",
          "code_type": "Date"
        },
        {
          "db_type": "Timestamp",
          "code_type": "Timestamp"
        },
        {
          "db_type": "Regex",
          "code_type": "RegExp"
        },
        {
          "db_type": "Binary",
          "code_type": "Buffer"
        }
      ]
    },
    {
      "name": "MySQL",
      "alias": "mysql",
      "imports": {
        "driver": {
          "path": "driver import from \"...\""
        },
        "storage": {
          "path": "storage import from \"...\""
        }
      },
      "storage": {
        "name": "MySqlStorage",
        "source": {
          "name": "MySqlSource"
        },
        "config": {
          "name": "MySqlConfig"
        }
      },
      "mappings": [
        {
          "db_type": "DATETIME",
          "code_type": "Date"
        }
      ]
    }
  ],
  "code": {
    "module": "@cole-framework/code-cli-typescript",
    "name": "TypeScript",
    "alias": "typescript",
    "types": [
      "string",
      "number",
      "boolean",
      "object",
      "any",
      "unknown",
      "null",
      "Array",
      "Set",
      "Map",
      "Date",
      "Buffer",
      "bigint",
      "void"
    ]
  },
  "components": {
    "mapper": {
      "name_pattern": "{{pascal name}}{{pascal type}}Mapper",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/data/mappers/{{kebab name}}.{{kebab type}}.mapper.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true,
          "methods": [
            {
              "name": "toEntity",
              "params": [
                {
                  "name": "model",
                  "type": "{{USE DEPENDENCY(WHERE type.isModel IS true).type}}"
                }
              ],
              "return_type": "{{USE DEPENDENCY(WHERE type.isEntity IS true).type}}"
            },
            {
              "name": "toModel",
              "params": [
                {
                  "name": "entity",
                  "type": "{{USE DEPENDENCY(WHERE type.isEntity IS true).type}}"
                }
              ],
              "return_type": "{{USE DEPENDENCY(WHERE type.isModel IS true).type}}"
            }
          ]
        },
        "mongo": {
          "inheritance": [
            {
              "name": "MongoMapper",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}"
                },
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isModel IS true).element.name}}"
                }
              ]
            }
          ],
          "interfaces": [],
          "imports": [
            {
              "list": [
                "MongoDB",
                "MongoMapper"
              ],
              "path": "@cole-framework/storage-mongodb"
            }
          ]
        }
      }
    },
    "source": {
      "name_pattern": "{{pascal name}}{{pascal type}}Source",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/data/sources/{{kebab name}}.{{kebab type}}.source.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true
        },
        "mongo": {
          "ctor": {
            "params": [
              {
                "name": "dbSource",
                "type": "MongoSource"
              }
            ],
            "supr": {
              "params": [
                {
                  "name": "dbSource",
                  "type": "MongoSource"
                },
                {
                  "name": "table",
                  "type": "string",
                  "value": "{{USE addons.table}}"
                }
              ]
            }
          },
          "inheritance": [
            {
              "name": "MongoCollectionSource",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isModel IS true).element.name}}"
                }
              ]
            }
          ],
          "interfaces": [],
          "imports": [
            {
              "list": [
                "MongoSource",
                "MongoCollectionSource"
              ],
              "path": "@cole-framework/storage-mongodb"
            }
          ]
        }
      }
    },
    "entity": {
      "name_pattern": "{{pascal name}}",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/domain/entities/{{kebab name}}.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true,
          "generics": [
            {
              "meta": "{{IF addons.hasModel IS true}}",
              "dflt": "{{USE DEPENDENCY(WHERE type.isModel IS true).element.name}}"
            }
          ],
          "methods": [
            {
              "meta": "{{IF addons.hasModel IS true}}",
              "name": "toModel",
              "params": [],
              "return_type": "{{USE DEPENDENCY(WHERE type.isModel IS true).type}}"
            }
          ],
          "imports": [
            {
              "list": [
                "Entity",
                "UnknownObject"
              ],
              "path": "@cole-framework/api-core"
            }
          ],
          "props": [
            {
              "access": "public",
              "default": "\"\"",
              "name": "id",
              "type": "string",
              "optional": false
            },
            {
              "access": "public",
              "name": "rest",
              "type": "string",
              "optional": true
            }
          ]
        }
      }
    },
    "model": {
      "name_pattern": "{{pascal name}}{{pascal type}}Model",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/data/dtos/{{kebab name}}.dto.ts",
      "element_type": "type",
      "defaults": {
        "common": {
          "exp": true
        },
        "mongo": {
          "imports": [
            {
              "list": [
                "MongoDB"
              ],
              "path": "@cole-framework/storage-mongodb"
            }
          ],
          "props": [
            {
              "name": "_id",
              "type": "MongoDB.ObjectId",
              "optional": true
            }
          ]
        },
        "json": {
          "imports": [],
          "props": [
            {
              "name": "id",
              "type": "string",
              "optional": true
            }
          ]
        }
      }
    },
    "use_case": {
      "name_pattern": "{{pascal name}}UseCase",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/domain/use-cases/{{kebab name}}.use-case.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true,
          "imports": [
            {
              "list": [
                "injectable",
                "inject",
                "UseCase",
                "Result",
                "Failure"
              ],
              "path": "@cole-framework/api-core"
            }
          ],
          "methods": [
            {
              "name": "execute",
              "params": "{{USE addons.input TO BUILD Array<Param>}}",
              "return_type": "{{USE addons.output.type}}",
              "async": true
            }
          ]
        }
      }
    },
    "repository": {
      "name_pattern": "{{pascal name}}Repository",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/domain/repositories/{{kebab name}}.repository.ts",
      "element_type": "abstract_class",
      "defaults": {
        "common": {
          "exp": true,
          "imports": [
            {
              "list": [
                "Repository",
                "injectable"
              ],
              "path": "@cole-framework/api-core"
            },
            {
              "list": [
                "{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}"
              ],
              "path": "{{USE DEPENDENCY(WHERE type.isEntity IS true).path}}"
            } 
          ],
          "inheritance": [
            {
              "name": "Repository",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}"
                }
              ]
            }
          ]
        }
      }
    },
    "repository_impl": {
      "name_pattern": "{{pascal name}}RepositoryImpl",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/data/repositories/{{kebab name}}.repository-impl.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true,
          "imports": [
            {
              "list": [
                "DataContext",
                "Repository",
                "RepositoryImpl"
              ],
              "path": "@cole-framework/api-core"
            }
          ],
          "inheritance": [
            {
              "name": "RepositoryImpl",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}"
                },
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isModel IS true).element.name}}"
                }
              ]
            }
          ],
          "interfaces":[
            {
              "name": "{{USE DEPENDENCY(WHERE type.isRepository IS true).element.name}}",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}"
                }
              ]
            }
          ],
          "ctor": {
            "supr": {
              "params": [{
                "name": "{{USE DEPENDENCY(WHERE type.isModel IS true).type.type}}",
                "type": "DataContext<{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}, {{USE DEPENDENCY(WHERE type.type IS mongo).element.name}}>"
              }]
            }
          }
        },
        "mongo": {
          "ctor": {
              "params": [{
                "name": "{{USE DEPENDENCY(WHERE type.isModel IS true).type.type}}",
                "type": "DataContext<{{USE DEPENDENCY(WHERE type.isEntity IS true).element.name}}, {{USE DEPENDENCY(WHERE type.type IS mongo).element.name}}>"
              }]
          }
        }
      }
    },
    "repository_factory": {
      "name_pattern": "{{pascal name}}RepositoryFactory",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/data/repositories/{{kebab name}}.repository-factory.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true
        },
        "mongo": {
          "imports": [
            {
              "list": [
                "MongoCollectionSource",
                "MongoConfig",
                "MongoQueryBuilders",
                "MongoSource"
              ],
              "path": "@cole-framework/storage-mongodb"
            },
            {
              "list": [
                "RepositoryImpl",
                "Container"
              ],
              "path": "@cole-framework/api-core"
            }
          ],
          "props": [],
          "methods": [
            {
              "name": "create",
              "params": [],
              "return": null,
              "async": true,
              "access": "public",
              "static": true
            }
          ]
        }
      }
    },
    "controller": {
      "name_pattern": "{{pascal name}}Controller",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/domain/controllers/{{kebab name}}.controller.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true
        }
      }
    },
    "route": {
      "name_pattern": "{{pascal method}}{{pascal name}}Route",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/routes/{{kebab method}}-{{kebab name}}.route.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true,
          "methods": [
            {
              "name": "create",
              "static": true,
              "params": [
                {
                  "name": "handler",
                  "type": "RouteHandler"
                }
              ]
            }
          ],
          "ctor": {
            "access": "private",
            "params": [
              {
                "name": "handler",
                "type": "RouteHandler"
              }
            ],
            "supr": {
              "params": [
                {
                  "name": "path",
                  "type": "string",
                  "value": "{{USE addons.path}}"
                },
                {
                  "name": "handler",
                  "type": "RouteHandler",
                  "value": "handler"
                },
                {
                  "name": "addons",
                  "type": "RouteAddons",
                  "value": {
                    "io": "{{USE DEPENDENCY(WHERE type.component IS route_io).element.name}}"
                  }
                }
              ]
            }
          }
        },
        "get": {
          "imports": [
            {
              "list": [
                "UnknownObject",
                "GetRoute",
                "RouteHandler"
              ],
              "path": "@cole-framework/api-core"
            }
          ]
        },
        "post": {
          "imports": [
            {
              "list": [
                "UnknownObject",
                "PostRoute",
                "RouteHandler"
              ],
              "path": "@cole-framework/api-core"
            }
          ]
        },
        "put": {
          "imports": [
            {
              "list": [
                "UnknownObject",
                "PutRoute",
                "RouteHandler"
              ],
              "path": "@cole-framework/api-core"
            }
          ]
        },
        "patch": {
          "imports": [
            {
              "list": [
                "UnknownObject",
                "PatchRoute",
                "RouteHandler"
              ],
              "path": "@cole-framework/api-core"
            }
          ]
        },
        "delete": {
          "imports": [
            {
              "list": [
                "UnknownObject",
                "DeleteRoute",
                "RouteHandler"
              ],
              "path": "@cole-framework/api-core"
            }
          ],
          "props": []
        }
      }
    },
    "route_model": {
      "name_pattern": "{{pascal name}}{{pascal type}}Model",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/routes/{{kebab name}}.route-model.ts",
      "element_type": "type",
      "defaults": {
        "common": {
          "exp": true
        }
      }
    },
    "route_io": {
      "name_pattern": "{{pascal method}}{{pascal name}}RouteIO",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/routes/{{kebab method}}-{{kebab name}}.route-io.ts",
      "element_type": "type",
      "defaults": {
        "common": {
          "exp": true,
          "interfaces": [
            {
              "name": "RouteIO",
              "generics": [
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.type IS input).element.name}}"
                },
                {
                  "dflt": "{{USE DEPENDENCY(WHERE type.type IS output).element.name}}"
                }
              ]
            }
          ],
          "methods": [
            {
              "name": "toResponse",
              "return_type": "{{USE DEPENDENCY(WHERE type.type IS input).type}}",
              "params": [
                {
                  "name": "output",
                  "type": "{{USE DEPENDENCY(WHERE type.type IS output).type}}"
                }
              ]
            },
            {
              "name": "fromRequest",
              "return_type": "Response",
              "params": [
                {
                  "name": "request",
                  "type": "Request<{{USE DEPENDENCY(WHERE type.type IS query_params).element.name}}, {{USE DEPENDENCY(WHERE type.type IS path_params).element.name}}, {{USE DEPENDENCY(WHERE type.type IS request_body).element.name}}>"
                }
              ]
            }
          ]
        }
      }
    },
    "tool": {
      "name_pattern": "{{pascal name}}Tools",
      "path_pattern": "{{root}}/endpoints/{{kebab endpoint}}/{{kebab layer}}/tools/{{kebab name}}.tools.ts",
      "element_type": "class",
      "defaults": {
        "common": {
          "exp": true
        }
      }
    }
  }
}